
#load "./../module"

use core {*}
use otmp

main :: () {
    registry := otmp.registry();
    registry->load_directory("./templates", ".html");

    registry->define_proc("testing", (a: str, b: i32) -> [] i32 {
        printf("This works! {} {}\n", a, b);
        return iter.comp(iter.as_iter(0 .. b), [](it + 1));
    });


    registry->render_template("test", &stdio.print_writer, &.{ var="Variable worked!", num=68, bar = .{ list=.[1,2,3] } });
    io.stream_flush(^stdio.stream);
}

